<!DOCTYPE html>
<html lang="ar">
<head>
<meta charset="UTF-8">
<title>حاسبة الخزائن والحلق السفلي</title>
<style>
body { font-family: "Tahoma", sans-serif; direction: rtl; margin: 20px; }
h2 { color: #333; }
.container { display: flex; gap: 20px; }
.section { border: 1px solid #aaa; padding: 15px; border-radius: 8px; width: 48%; }
label { display: block; margin-top: 10px; }
input, select { margin-top: 5px; width: 100px; }
button { margin-top: 15px; padding: 5px 15px; cursor: pointer; }
.results { margin-top: 20px; background: #f9f9f9; padding: 15px; border-radius: 8px; }
.item { margin-bottom: 15px; padding-bottom: 10px; border-bottom: 1px dashed #ccc; }
.divider-row { display:flex; gap:5px; margin-top:5px; align-items:center;}
</style>
</head>
<body>

<h2>📐 برنامج حساب الخزائن والحلق السفلي</h2>

<div class="container">
  <div class="section">
    <h3>➕ إضافة خزانة</h3>
    <label>العرض (سم): <input type="number" id="cabWidth"></label>
    <label>الارتفاع (سم): <input type="number" id="cabHeight"></label>
    <label>العمق (سم): <input type="number" id="cabDepth"></label>
    <label>عدد الأبواب:
      <select id="cabDoors">
        <option value="1">باب واحد</option>
        <option value="2">بابان</option>
      </select>
    </label>
    <button onclick="addCabinet()">إضافة خزانة</button>
  </div>

  <div class="section">
    <h3>➕ إضافة حلق سفلي</h3>
    <label>العرض (سم): <input type="number" id="frameWidth"></label>
    <label>الارتفاع (سم): <input type="number" id="frameHeight"></label>
    <div id="dividerContainer"></div>
    <label>عدد أبواب المقطع الأخير: 
      <select id="lastSegmentDoors">
        <option value="1">1 باب</option>
        <option value="2">2 باب</option>
      </select>
    </label>
    <button onclick="addDividerRow()">➕ إضافة قاطع</button>
    <button onclick="addFrame()">إضافة حلق</button>
  </div>
</div>

<div class="results" id="results">
<h3>📊 النتائج:</h3>
</div>

<button onclick="printResults()">🖨️ طباعة النتائج</button>

<script>
let resultsDiv = document.getElementById("results");

// الخزائن
function addCabinet() {
  let wMain = parseFloat(document.getElementById("cabWidth").value);
  let hMain = parseFloat(document.getElementById("cabHeight").value);
  let dMain = parseFloat(document.getElementById("cabDepth").value);
  let doors = parseInt(document.getElementById("cabDoors").value);

  if(wMain<=0||hMain<=0||dMain<=0){ alert("❌ أدخل قياسات صحيحة للخزانة"); return; }

  let w = wMain-5, h = hMain-5, d = dMain-5;
  let item=document.createElement("div"); item.className="item";

  let doorHeight = (doors===1)?hMain-2.5:hMain-2.5;
  let doorWidth = (doors===1)?wMain-3:(wMain-4)/2;
  let doorCount=(doors===1)?2:4;
  let hinges = doorCount*2;
  let handles = doorCount;
  let angles = doorCount*4;
  let doorDesc = (doors===1)?
    `باب واحد: ${doorWidth} × ${doorHeight} سم — فصالات 2 / يد 1 — عدد كل قياس: عرض ${doorCount} × ارتفاع ${doorCount}`:
    `بابان: ${doorWidth} × ${doorHeight} سم لكل باب — فصالات 2 / يد 1 لكل باب — عدد كل قياس: عرض 4 × ارتفاع 4`;

  item.innerHTML = `
    <h4>🗄️ خزانة</h4>
    الأبعاد بعد خصم البروفيلات: عرض ${w} × ارتفاع ${h} × عمق ${d}<br>
    <b>تفاصيل البروفيلات:</b><br>
    - ارتفاع: 2 × ${h} سم (بسنين) + 2 × ${h} سم (بسن واحد)<br>
    - عرض: 2 × ${w} سم (بسنين) + 2 × ${w} سم (بسن واحد)<br>
    - عمق: 4 × ${d} سم (بسنين)<br>
    <b>تفاصيل الأبواب:</b><br>${doorDesc}<br>
    <div>عدد الزوايا لكل خزانة: 8</div>
    <div>ملخص: الأبواب ${doorCount} — الفصالات ${hinges} — الأيدي ${handles} — الزوايا ${angles}</div>
  `;
  resultsDiv.appendChild(item);
}

// الحلقات
function addDividerRow(){
  let container=document.getElementById("dividerContainer");
  let row=document.createElement("div"); row.className="divider-row";
  row.innerHTML=`
    <input type="number" placeholder="مسافة القاطع من البداية" class="divPos">
    <select class="divDoors">
      <option value="1">1 باب</option>
      <option value="2">2 باب</option>
    </select>
    <button onclick="this.parentElement.remove()">× حذف</button>
  `;
  container.appendChild(row);
}

// إضافة حلق
function addFrame(){
  let w=parseFloat(document.getElementById("frameWidth").value);
  let h=parseFloat(document.getElementById("frameHeight").value);
  if(w<=0||h<=0){ alert("❌ أدخل قياسات صحيحة"); return; }

  let lastDoors = parseInt(document.getElementById("lastSegmentDoors").value);

  let rows=document.querySelectorAll(".divider-row");
  let dividers=[];
  rows.forEach(r=>{
    let pos=parseFloat(r.querySelector(".divPos").value);
    let doors=parseInt(r.querySelector(".divDoors").value);
    if(!isNaN(pos)&&pos>0) dividers.push({position:pos, doors:doors});
  });
  dividers.sort((a,b)=>a.position-b.position);

  let item=document.createElement("div"); item.className="item";
  let lastPos=0; let sectionDetails=""; let doorHeight=h-2.5;

  dividers.forEach((d,i)=>{
    let sectionWidth=d.position-lastPos-(i>0?2.7:0);
    let perDoorWidth = sectionWidth / d.doors;
    sectionDetails+=`المقطع ${i+1}: عرض ${sectionWidth.toFixed(1)} سم × ارتفاع ${doorHeight.toFixed(1)} سم — ${d.doors} باب(أبواب)<br>`;
    for(let j=0;j<d.doors;j++){
      sectionDetails+=`&nbsp;&nbsp;- الباب ${j+1}: عرض ${perDoorWidth.toFixed(1)} × ارتفاع ${doorHeight.toFixed(1)} سم<br>`;
    }
    lastPos=d.position;
  });

  // المقطع الأخير بعد آخر قاطع
  let remainingWidth=w-lastPos-(dividers.length>0?2.7:0);
  let perDoorWidthLast = remainingWidth / lastDoors;
  sectionDetails+=`المقطع ${dividers.length+1}: عرض ${remainingWidth.toFixed(1)} سم × ارتفاع ${doorHeight.toFixed(1)} سم — ${lastDoors} باب(أبواب)<br>`;
  for(let j=0;j<lastDoors;j++){
    sectionDetails+=`&nbsp;&nbsp;- الباب ${j+1}: عرض ${perDoorWidthLast.toFixed(1)} × ارتفاع ${doorHeight.toFixed(1)} سم<br>`;
  }

  // ملخص القواطع
  let summary="عدد القواطع: "+dividers.length+" — ";
  summary+="مسافات القواطع: ["+dividers.map(d=>d.position).join(", ")+"] — ";
  summary+="عدد أبواب كل مقطع: ["+dividers.map(d=>d.doors).join(", ")+", "+lastDoors+"]";

  item.innerHTML=`
    <h4>🚪 حلق سفلي</h4>
    الأبعاد: عرض ${w} × ارتفاع ${h}<br>
    <b>تفاصيل المقاطع:</b><br>${sectionDetails}
    <div>${summary}</div>
  `;
  resultsDiv.appendChild(item);
  document.getElementById("dividerContainer").innerHTML=""; // إعادة ضبط القواطع
}

// طباعة النتائج فقط
function printResults(){
  let content=document.getElementById("results").innerHTML;
  let myWindow=window.open("","Print","width=800,height=600");
  myWindow.document.write("<html><head><title>نتائج الطباعة</title></head><body>"+content+"</body></html>");
  myWindow.document.close(); myWindow.print();
}
</script>
</body>
</html>

